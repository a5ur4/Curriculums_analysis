# Curriculum Analyzer

This project is a Python script that analyzes PDF files containing curriculums (CVs) to extract contact information, work experience, and keywords related to specific technologies. The results are saved in an Excel file.

## Requirements

- Python 3.x
- pytesseract
- opencv-python
- openpyxl
- pdf2image

## Installation

1. **Clone the Repository or Download the Script**

2. **Install Required Python Packages**

   ```sh
   pip install pytesseract opencv-python openpyxl pdf2image
   ```

3. **Install External Tools**

   - **Tesseract OCR:**  
     [Tesseract OCR](https://github.com/tesseract-ocr/tesseract)
     
   - **Poppler:**  
     [Poppler](http://blog.alivate.com.au/poppler-windows/)

## Usage

1. **Prepare Your Files**  
   Place the PDF files containing the curriculums in a designated folder.

2. **Update Directory Paths**  
   Edit the following variables in the script to point to your directories:
   
   - `folder_path`: Directory where your PDF files are stored.
   - `path_tesseract`: Path to the Tesseract OCR installation.
   - `poppler_path`: Path to the Poppler binaries.
   - `save_path`: Directory where image and Excel outputs will be saved.
   - `txt_save_path`: Directory where text and JSON outputs will be saved.

3. **Run the Script**

   ```sh
   python main.py
   ```

   The script will process the PDFs by converting them to images, performing OCR to extract text, and then analyzing that text to generate an Excel report.

## LLM Integration with Ollama

This project integrates with a language model (LLM) to generate concise candidate summaries based on the extracted resume data. To use Ollama as your LLM provider, follow these steps:

1. **Install Ollama**  
   Download and install Ollama from the [official website](https://ollama.com).

2. **Set Up Your LLM**  
   Use Ollama to pull or install your desired language model (e.g., `llama3.2`). For example:

   ```sh
   ollama pull llama3.2
   ```

   Adjust the model name in the script (inside the `send_to_llm` function) if necessary.

3. **Configure the API Endpoint**  
   The script is configured by default to use the endpoint `http://localhost:11434/api/generate`.  
   If Ollama uses a different endpoint or port, update the URL accordingly in the `send_to_llm` function within the script.

4. **Run the Project with LLM Support**  
   With Ollama running and your LLM model loaded, execute the script as described above:

   ```sh
   python main.py
   ```

   The script will send a request to your local LLM to generate a summary for each processed curriculum.

## Script Details

- **Keyword Search:**  
  The script searches for the following keywords in the curriculums:  
  `Java`, `Spring`, `Python`, `Django`, `JavaScript`, `React`, `Node`, `SQL`, `NoSQL`, `MongoDB`, `PostgreSQL`, `MySQL`, `HTML`, `CSS`, `Bootstrap`.

- **Data Extraction:**  
  It extracts contact information (phone numbers and email addresses) and work experience (including time periods and roles).

- **Approval Logic:**  
  A curriculum is marked as "approved" if it contains more than 5 of the specified keywords.

- **LLM Summary:**  
  A candidate summary is generated by sending the extracted data to the LLM. The summary is concise and formatted based on a predefined prompt focusing on core competencies, key experience highlights, technical skills, and education.

## Functions

- **`convert_to_image(file_path, poppler_path, save_path)`:**  
  Converts PDF pages to images.

- **`extract_text(image_path)`:**  
  Extracts text from images using Tesseract OCR.

- **`extract_name_from_text(text)`:**  
  Extracts names from the given text.

- **Other Functions:**  
  Additional functions handle contact extraction, experience extraction, keyword evaluation, Excel spreadsheet creation, and communication with the LLM.

## Output

The final Excel file contains the following columns:

- **File:** The name of the PDF file.
- **Name:** Extracted name of the candidate.
- **Phones:** Extracted phone numbers.
- **Emails:** Extracted email addresses.
- **Approved:** Whether the curriculum is approved (Yes/No).
- **Experiences:** Extracted work experience details.
- **LLM Summary:** Summary generated by the LLM.

## License

This project is licensed under the MIT License.

---

Follow these steps to run the project and integrate with Ollama for generating LLM summaries. If you have any questions or run into issues, feel free to reach out for assistance!
